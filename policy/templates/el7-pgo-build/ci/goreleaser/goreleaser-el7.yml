# Generated by: gromit policy

# A special goreleaser that only builds packages
# - arm64
# - amd64

{{- if has "el7-pgo-build" .Branchvals.Features }}
  {{- template "cgo_builds" . }}
{{- else }}
  {{- template "builds" . }}
{{- end }}
{{- template "nfpm" . }}

publishers:
  - name: {{ .PCRepo }}-unstable
    env:
      - PACKAGECLOUD_TOKEN={{`{{ .Env.PACKAGECLOUD_TOKEN }}`}}
    cmd:  {{`packagecloud publish --debvers "{{ .Env.DEBVERS }}" --rpmvers "{{ .Env.RPMVERS }}"`}} tyk/{{ .PCRepo }}-unstable {{`{{ .ArtifactPath }}`}}

# This disables archives
archives:
  - format: binary
    allow_different_binary_count: true

checksum:
  disable: true

release:
  disable: true
  github:
    owner: TykTechnologies
    name: {{ .Name }}
  prerelease: auto
  draft: true
  name_template: "{{ `{{.ProjectName}}-v{{.Version}}` }}"
