# Generated by: gromit policy
# Generated on: {{ .Timestamp }}

# Distribution channels covered by this workflow
# - Ubuntu and Debian
# - RHEL and AL
# - docker hub
# - devenv ECR
# - AWS mktplace (not active atm)
# - Cloudsmith

name: Release

on:
  pull_request:
  push:
    branches:
      - master
      - release-**
    tags:
      - 'v*'

env:
  SLACK_CLI_TOKEN: ${{`{{ secrets.BENDER_TOKEN }}`}}
  GOPRIVATE: github.com/TykTechnologies
  
jobs:
{{- template "goreleaser" . }}
  sbom:
    needs: goreleaser
    uses: TykTechnologies/github-actions/.github/workflows/sbom.yaml@main
    secrets:
      TF_API_TOKEN: ${{`{{ secrets.TF_API_TOKEN }}`}}
      DEPDASH_URL: ${{`{{ secrets.DEPDASH_URL }}`}}
      DEPDASH_KEY: ${{`{{ secrets.DEPDASH_KEY }}`}}
      ORG_GH_TOKEN: ${{`{{ secrets.ORG_GH_TOKEN }}`}}
{{- template "tests" . }}
